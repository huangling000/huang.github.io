1. **索引：业务相关**



2. **语法优化**

* 解析sql

sql语句语法分析，解析为语法树，使用sql优化规则重构sql语法树，遍历重构的语法树得到优化后的sql。

语法优化：函数提前计算、判断永真永假式确定索引、合并范围得到确定索引、类型处理

下推优化：

![image-20201230161147784](C:\Users\黄玲\AppData\Roaming\Typora\typora-user-images\image-20201230161147784.png)

如何实现条件过滤，A.query是什么，提前获取数据也需要进行查询？

![image-20201230161437510](C:\Users\黄玲\AppData\Roaming\Typora\typora-user-images\image-20201230161437510.png)

为什么要进行提前过滤？提前过滤是指join之前进行提前的范围锁定吗？为什么可以达到优化。

3. **分库分表：数据量剧增,拆分表单，降低表单数据量，提升查询性能**

* 垂直分表

常用的列独立成主表，不常用的列以及长列拆分成拓展表：

> 冷热分离，常用列与不常用列分离
>
> 大字段列独立存放
>
> 关联关系列紧密放在一起

提升点：

​        避免IO争抢，减少查询访问时出现锁表几率，关系不大信息不互相影响。

​        使用率高的数据操作不会被冷门数据或长字段数据操作拖累。

* 水平分表

分出来的表包含部分数据，解决单一表数据量过大问题，提高检索性能

那我的数据应该到哪一个表进行检索呢？不也是要进行表的一个遍历吗？

避免IO争抢并减少锁表的机会。（可是有锁的原子操作，尽量只锁住某一行相关数据？感觉用处不太大？）

* 垂直分库

按照业务将表进行分类，分布到不同的数据库上，每个数据库可以放在不同的服务器上，实现专库专用。

> 解决业务层面耦合
>
> 对不同业务数据便于分级管理，维护，监控，扩展等。
>
> 达到多个服务器分摊压力效果。

* 水平分库

把同一个表数据按一定规则拆分到不同数据库中，每个库可以放在不同的服务器上。（是不是类似于一个分布式的库，需要有一个服务器来进行元数据的管理，让某条指令到哪个服务器上的某个库进行查询，那么这样网络延迟也会比较严重？）

> 解决单库单表数据量过大问题，理论上解决高并发的性能瓶颈（高并发是指多个请求向同一台服务器吗？如果是不同用户同时对同一数据进行操作，这样的性能似乎没有什么改变）

水平分库解决

两表连接，大表在前。