**简单动态字符串**

​          *Redis里，C语言字符串只会用作字符串字面量，用于打印日志等无需修改字符串的地方。对于一个可以修改的字符串，使用SDS来表示*

1、一个SDS值的结构

```
struct sdshdr {

    // 记录 buf 数组中已使用字节的数量
    // 等于 SDS 所保存字符串的长度
    int len;

    // 记录 buf 数组中未使用字节的数量
    int free;

    // 字节数组，用于保存字符串
    char buf[];

};
```

三个值：**len**，**free**，**buf[]**，字符串以空字符 `'\0'`结尾。

2、SDS与C字符串的区别

C字符串获取长度O(N)，SDS获取字符串长度O(1)，好处：字符串键在底层用SDS表示，读取不会成为性能瓶颈。

杜绝缓冲区溢出的可能性：C语言字符串在进行更新赋值前要手动分配好字符串内存大小，否则容易缓冲区溢出。而SDS会在修改字符串之前进行空间的判断与修改，防止缓冲区溢出或内存泄露。

